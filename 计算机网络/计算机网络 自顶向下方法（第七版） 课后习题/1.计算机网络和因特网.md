# 第1章 计算机网络和因特网

## 复习题

### 1.1
* **R1. “主机”和“端系统”之间有什么不同？列举几种不同类型的端系统。Web服务器是一种端系统吗？** 
  
    答案： 
    
  主机和端系统在本书中是同一个概念。常见的端系统比如笔记本电脑、智能手机、个人电脑、智能家电、服务器等。Web服务器是一种端系统。


* **R2. “协议”一词常被用于描述外交关系。维基百科是怎样描述外交协议的？**
  
  答案：

    略。


* **R3. 标准对于协议为什么重要？**

  答案：
  
  标准定义了协议的要做什么和具体内容。 

### 1.2

* **R4. 列出6种接入技术。将它们分类为住宅接入、公司接入或广域无线接入。**

    答案：

    * 住宅接入：DSL接入（电话线）、电缆因特网接入（有线电视光缆）、光纤到户
    * 公司接入：以太网（局域网技术的一种）、WiFi
    * 广域无线接入：3G、4G、5G


* **R5. HFC宽带是专用的，还是用户间共享的？在下行HFC信道中，有可能发生碰撞吗？为什么？***

  答案：
  
  HFC系统：光缆将电缆头端连接到地区枢纽，从这里使用传统的同轴电缆到各家各户和公寓，因为在这个系统中应用了光纤和同轴电缆，所以它经常被称为混合光纤同轴 (Hybrid Fiber Coax , HFC)。HFC系统带宽是用户间共享的，因为电缆因特网接入的一个重要特征是共享广播媒体。特别是，由头端发送的每个分组向下行经每段链路到每个家庭；每个家庭发送的每个分组经上行信道向头端传输。下行HFC信道中不会发生碰撞。因为分组是由一个源发出，由不同的端系统接受，因此不存在冲突。


* **R6. 列出你所在城市中的可供使用的住宅接入技术。对于每种类型的接入方式，给出所宣称的下行速率、上行速率和每月的价格。**

  答案：
  
  略。


* **R7. 以太LAN的传输速率是多少？**

  答案：
  使用以太网接入，用户通常以 1OOMbps 或 1Gbps 的速率接入以太网交换机，而服务器可能具有 lGbps 甚至 10Gbp 的接入速率。


* **R8. 能够运行以太网的一些物理媒体是什么？**

  答案：

  双绞铜线、同轴电缆、光纤等等、无线LAN。


* **R9. 拨号调制解调器、HFC、DSL和FTTH都用于住宅接入。对于这些技术中的每一种，给出传输速率的范围。并讨论有关宽带是共享的还是专用的。**

  答案：
  
  * 拨号调制解调器： 速率56kbps 带宽专用。传统的电话网络是电路交换网络的例子，也在连接期间在该网络链路上预留了恒定的传输速率。
  * HFC： 下行速率：42.8Mbps 上行速率：30.7Mbps 带宽共享 
  * DSL： 下行速率：24Mbps 上行速率:2.5Mbps 带宽共享 
  * FTTH: 平均下行速率：20Mbps 带宽共享


* **R10. 描述今天最流行的无线因特网接入技术。对它们进行比较和对照。**
  
  答案： 
  
  WiFi和4G接入。 WiFi速度快但距离短，4G速度慢但距离远。


* **R11. 假定在发送主机和接收主机间只有一台分组交换机。发送主机和交换机间以及交换机和接收主机间的传输速率分别是R1和R2。假设该交换机使用存储转发分组交换方式，发送一个长度为L的分组的端到端总时延是什么？（忽略排队时延、传播时延和处理时延）**

  答案： 

  总时延=L/R1+L/R2


* **R12. 与分组交换网络相比，电路交换网络有哪些优点？在电路交换网络中，TDM比FDM有哪些优点？**
  
  答案：

  电路交换网络的优点
  1. 为该发送方－接收方连接预留了带宽，则发送方能够以确保的恒定速率向接收方传送数据。
  2. 不会因为其他链路的传输产生拥塞进而导致等待产生的时延。
  3. 更适合实时服务（例如，电话和视频会议） 因为它的端到端时延是可以预测的。
  4. 更简单和有效，成本更低。

  TDM（时分复用）比FDM（频分复用）的优点如下：
  
  不知道。


* **R13. 假定用户共享一条2Mbps链路。同时假定当每个用户传输时连续以1Mbps传输，但每个用户仅传输20%的时间。**
  
  **a. 当使用电路交换时，能够支持多少用户？**
  
  **b. 作为该题的遗留问题，假定使用分组交换。为什么如果两个或更少的用户同时传输的话，在链路前面基本没有排队时延？为什么如果3个用户同时传输的话，将会有排队时延？**

  **c. 求出某指定用户正在传输的概率。**
  
  **d. 假定现在有3个用户。求出在任何给定时间，所有3个用户在同时传输的概率。求出队列增长的时间比率。**
        
  答案：

  a.使用电路交换时，在所有的时间内必须为每个用户预留 1Mbps，因此只能支持2个并发的用户。

  b.如果两个或更少的用户在传输，即使它们同时传输，也仅仅完全占用了2Mbps链路，不会造成排队。如果有3个用户同时传输，需要3Mbps，而此时链路只有2Mbps，因此将会有排队时延。

  c.指定用户正在传输的概率为20%。

  d.符合二项分布，因此在任何给定的时间，所有三个用户同时传输的概率为0.2*0.2*0.2=0.008。因为只有三个用户时，队列才会增长，所以队列增长的时间比率为0.008。


* **R14. 为什么在等级结构相同级别的两个ISP通常互相对等？某IXP是如何挣钱的？**

  答案：
  
  每个接入ISP向其连接的区域ISP支付费用， 并且每个区域ISP向它连接的第一层ISP 支付费用。单个接入ISP也能直接与第一层ISP连接，这样它就向第一层ISP付费）因此，在这个等级结构的每一层，都有客户－提供商关系。为了减少这些费用，位于相同等级结构层次的邻近一对ISP能够对等, 也就是说，能够直接将它们的网络连到一起，使它们之间的所有流量直接连接而不是通过上游的中间ISP。当两个 ISP 对等时，通常不进行结算，即任意ISP不向其对等ISP付费。

  第三方公司能够创建一个因特网交换点 (Internet Exchange Point, IXP) , IXP是一个个汇合点，多个ISP能够在这里一起对等。IXP可以通过交换的流量对ISP收费。


* **R15. 某些内容提供商构建了自己的网络。描述谷歌的网络。内容提供商构建这些网络的动机是什么？**

  答案：
  
  谷歌的网络：在本书写作的时候，谷歌估计有30-50个数据中心。谷歌的数据中心经过专用的TCP/IP网络互连，该网络跨越全球，但仍然独立于公共因特网。 

  内容提供商构建这些网络的动机是：直接与较低层ISP对接，减少向ISP支付的费用。对其服务最终如何交付给端用户有了更多的控制。


* **R16. 考虑从某源主机跨越一条固定路由向某目的主机发送一分组。列出端到端时延组成部分。这些时延中的哪些是固定的，哪些是变化的？**

  答案：
  
  端到端时延组成部分有：节点处理时延，排队时延，传输时延，传播时延。
  
  时延中固定的部分有：传输时延、传播时延、节点处理时延

  时延中变化的部分有： 排队时延（一个特定分组的排队时延长度将取决于先期到达的正在排队等待向链路传输的分组数量）


* **R17. 访问在配套Web网站上有关传输时延与传播时延的Java小程序。在可用速率、传播时延和可用的分组长度之中找出一种组合，使得该分组的第一个比特到达接收方之前发送方结束了传输。找出另一种组合，使得发送方完成传输之前，该分组的第一个比特到达了接收方。**

  答案：
  
  略。


* **R18. 一个长度为1000字节的分组经距离2500km的链路传播，传播速率为2.5x10^8m/s并且传输速率为2Mbps，它需要多长时间？更为一般地，一个长度为L的分组经距离为d的链路传播，传播速率为s并且传输速率为Rbps，它需要用多长时间？该时延与传输速率相关吗？**

  答案：
  
  （1） 传输时延：8Kb/2Mb = 4ms；传播时延：2500km/2.5x10^8m/s = 10ms；需要的时间为 14ms

  （2）传输时延：L/R；传播时延：d/s；需要的时间为：L/R + d/s；时延与传输速率有关。


* **R19. 假定主机A要向主机B发送一个大文件。从主机A到主机B的路径上有3段链路，其速率分别为R1 = 500kbps，R2 = 2Mbps，R3 = 1Mbps。**

  **a. 假定该网络中没有其他流量，该文件传送的吞吐量是多少？**

  **b. 假定该文件为4MB。用吞吐量除以文件长度，将该文件传输到主机B大致需要多长时间？**

  **c. 重复(a)和(b)，只是这时R2减小到100kbps。**

  答案：

  a.在任何时间瞬间的瞬时吞吐量接收到该文件的速率。因此吞吐量为500kbps。

  b.大致需要T=4×8×10^6/(500×10^3)=64s。

  c.吞吐量为100kbps，大致需要320s


* **R20. 假定端系统A要向端系统B发送一个大文件。在一个非常高的层次上，描述端系统怎样从该文件生成分组。当这些分组之一到达某分组交换机时，该交换机使用分组中的什么信息来决定将该分组转发到哪一条路上？因特网中的分组交换为什么可以与驱车从一个城市到另一个城市并沿途询问方向相类比？**

  答案：

  端系统利用应用层生成分组。 此时的分组交换机应该指的是路由器。路由器使用分组中的IP地址来决定将该分组转发到哪一条路。 每个路由器都有一个转发表，当某分组到达一台路由器时，路由器检查IP地址，并用这个地址搜索转发表，以发现适当的输出链路。这种方式与沿途询问方向类似。


* **R21. 访问配套Web站点的排队和丢包Java小程序。最大发送速率和最小的传输速率是什么？对于这些速率，流量强度是多少？用这些速率运行该Java小程序并确定出现丢包要花费多长时间？然后第二次重复该实验，再次确定出现丢包花费多长时间。这些值有什么不同？为什么会有这种现象？**

  答案： 
  
  页面不再维护。

  流量强度：`a`表示分组到达队列的平均速率 (`a`的单位是分组/秒，即 pkt/s)；`R`是传输速率，即从队列中推出比特的速率（以bps/s为单位）；假定所有分组都是由`L`比特组成。比率`La/R`被称为流量强度。如果`La/R > 1`则比特到达队列的平均速率超过从该队列传输出去的速率，此时队列中的分组会持续增加直到没有空间存储新到的分组，造成丢包。

  通常，到达队列的过程是随机的，即到达并不遵循任何模式，分组之间的时间间隔是随机的。所以每次出现丢包所花费的时间会不同。


* **R22. 列出一个层次能执行的5个任务。这些任务中的一个（或两个）可能由两个（或更多）层次执行吗？**

  答案：

  比如运输层，TCP的任务有：应用层报文向目的地的确保传递、长报文划分为短报文、拥塞控制、流量控制（发送/接收方的速率匹配）、可靠性。它的任务不是由两个（或更多）层次执行的。但是，很多层次的任务是互相重复的。


* **R23. 因特网协议栈中的5个层次有哪些？在这些层次中，每层的主要任务是什么？**

  答案：

  1. 应用层：是网络应用程序及它们的应用层协议存留的地方；报文
  2. 运输层：在应用程序端点之间传输运输层报文。主要有TCP和UDP两种协议；报文段
  3. 网络层：因特网的网络层负责将称为数据报 (datagram) 的网络层分组从一台主机移动到另一台主机，包括IP协议；数据报
  4. 链路层：沿着路经将数据报传递给下一层结点；帧
  5. 物理层：将整个帧从一个网络元素移动到邻近的网络元素，这一层的协议主要与物理线路有关。


* **R24. 什么是应用层报文？什么是运输层报文段？什么是网络层数据报？什么是链路层帧？**

  答案：

  1. 应用层报文：一个端系统与另一个端系统应用程序交换信息的分组。
  2. 运输层报文段：运输层的分组
  3. 网络层数据报：网络层的分组
  4. 链路层帧：链路层的分组


* **R25. 路由器处理因特网协议栈中的哪些层次？链路层交换机处理的是哪些层次？主机处理的是哪些层次？**

  答案：

  1. 路由器处理的层次：物理层 链路层 网络层
  2. 交换机处理的层次：物理层 链路层
  3. 主机处理的层次：物理层 链路层 网络层 运输层 应用层


* **R26. 病毒和蠕虫之间有什么不同？**

  答案：

  * 病毒：一种需要某种形式的用户交互来感染用户设备的恶意软件。
  * 蠕虫：一种无须任何明显用户交互就能进入设备的恶意软件。


* **R27. 描述如何产生一个僵尸网络，以及僵尸网络是怎样被用于DDoS攻击的。**

  答案：

  多数恶意软件是自我复制 (self- replicating) 的。

  病毒 (virus) 是一种需要某种形式的用户交互来感染用户设备的恶意软件，典型的例子是包含恶意可执行代码的电子邮件附件。如果用户接收并打开这样的附件，不经意间就在其设备上运行了该恶意软件，一旦执行，该病毒可能向用户地址簿上的每个接收方发送一个具有相同恶意附件的相同报文。

  蠕虫 (worm) 是一种种无须任何明显用户交互就能进入设备的恶意软件。例如用户也许运行了一个攻击者能够发送恶意软件的脆弱网络应用程序，在某些情况下，没有用户的任何干预，该应用程序可能从因特网接收恶意软件并运行它，新近感染设备中的蠕虫则能扫描因特网，搜索其他运行相同网络应用程序的易受感染的主机它发现其他易受感染的主机时，便向这些主机发送一个它自身的副本。

  如果某服务器的接入速率为 R bps, 则攻击者将需要以大约 R bps 的速率来产生危害。如果R非常大的话，单一攻击源可能无法产生足够大的流量来伤害该服务器。此外，如果从单一源发出所有流量的话，某上游路由器就能够检测出该攻击并在该流量靠近服务器之前就将其阻挡下来。分布式 DoS (Distributed DoS, DDoS) 中，攻击者控制多个源并让每个源向目标猛烈发送流量。使用这种方法，DDoS攻击充分利用由数以千计的受害主机组成的僵尸网络来发送流量或者创造TCP连接。

* **R28. 假定Alice和Bob经计算机网络相互发送分组。假定Trudy将自己安置在网络中，使得她能够俘获由Alice发送的所有分组，并发送她希望给Bob的东西；她也能俘获Bob发送的所有分组，并发送她希望给Alice的东西。列出在这种情况下Trudy能够做的某些恶意的事情。**

  答案：

  Trudy可以进行嗅探分组，得到传输分组的副本，还可以进行IP哄骗，冒充另一个用户。


* **P1. 设计并描述在自动柜员机和银行的中央计算机之间使用的一种应用层协议 你的协议应当允许验证用户卡和口令，查询账目结算（这些都在中央计算机中进行维护），支取账目（即向用户支付钱）你的协议实体应当能够处理取钱时账目中钱不够的常见问题 通过列出自动柜员机和银行中央计算机在报文传输和接收过程中交换的报文和采取的动作来定义你的协议。使用类似于图1-2所示的图，拟定在简单无差错取钱情况下该协议的操作，明确地阐述在该协议中关于底层端到端运输服务所做的假设**

  答案：

  略。


* **P2. 式(1-1)给出了经传输速率为`R`的`N`段链路发送长度`L`的一个分组的端到端时延，对于经过`N`段链路一个一个地发`P`个这样的分组，一般化地表示出这个公式**

  答案：

  我们将第一个分组被发出端发出的时刻记为0，那么`N*(L/R)`时刻第一个分组到达接收端，第二个分组被存储在最后一个路由中。在`N*(L/R)+L/R`时刻，第二个分组到达接收端。由此可以推出最后一个分组到达接收端用时为`N*(L/R) + (P-1)*(L/R) = (N+P-1)*(L/R)`。


* **P3. 考虑一个应用程序以稳定的速率传输数据（例如，发送方每 k 个时间单元产生 N 比特的数据单元，其中 k 较小且固定）另外，当这个应用程序启动时，它将连续运行相当长的一段时间。回答下列问题，简要论证你的回答：**

  **a. 是分组交换网还是电路交换网更为适合这种应用？为什么？**

  **b. 假定使用了分组交换网，并且该网中的所有流量都来自如上所述的这种应用程序 。此外，假定该应用程序数据传输速率的总和小于每条链路的各自容量，需要某种形式的拥塞控制吗？为什么？**

  答案：

  a. 电路交换网络更适合。因为应用程序发送的数据可预测且需要的带宽固定，并且是一个长会话。由于传输速率已知且不突发，因此可以认为每个应用程序会话都没有明显的浪费。 此外，管理、建立、拆除连接在持续时间长的时候更为适用。

  b. 由于每个链接都有足够的带宽来处理数据在所有应用程序的数据速率中，不会发生拥塞（很少排队），因此网络不需要拥塞控制机制。


* **P4 考虑在图 1-13 中的电路交换网，在每条链路上有4条链路，以顺时针方向标记四台交换机A、B、C、D。**

  **a. 在该网络中，任何时候能够进行同时连接的最大数址是多少？**
  **b. 假定所有连接位于交换机A、C之间，能够进行同时连接的最大数量是多少？**
  **c. 假定我们要在交换机A、C之间建立4条连接，在交换机B、D之间建立另外4条连接，我们能够让这些呼叫通过这4条链路建立路由以容纳所有8条连接吗？**

  答案：

  a. 为了使得连接数最大，那么每条连接最好只使用一条链路，因此我们可以将相邻的交换机相连来作为一条连接。这种情况下最大的连接数为16条。
  b. A-B-C、A-D-C分别有4条连接，所以最大连接数是8
  c. 可以。我们可以建立两条A-B-C的连接和两条A-D-C的连接，这时还可以建立两条B-A-D和两条B-C-D的连接。


* **P5. 回顾在 1.4 节中的车队的类比，假定传播速度为100km/h。**
  
  **a. 车队旅行150km；第一个收费站前面开始．通过第二个收费站，并且正好在第三个收费站后面结束，其端到端时延是多少？**

  **b. 重复 (a)' 现在假定车队中有8辆汽车而不是10辆**

  答案：

  收费站相距 150 公里，汽车以 100 公里/小时的速度行驶。每个收费站以每辆车 12s 的速度服务（即传输）汽车。最后，假定无论该车队的第1辆汽车何时到达收费站，它在入口处等待，直到其他汽车到达并整队依次前行（因此，整个车队在它能够“转发”之前，必须存储在收费站)

  a. 每个收费站推出车队的时间是`12*10 = 120s = 2min`，一辆汽车从第一个个收费站出口行驶到第三个收费站后所需要的时间是`150km/(100km/h) = 90min`，所以需要的时间总和是`2*3 + 90 = 96 min`。以所需要的总时间是：96分。

  b.`12*8*3 = 288s = 4min48s`，行驶时间是`150km/(100km/h) = 90min`，所以所需要的总时间是：94分48秒。


* **P6. 这个习题开始探讨传播时延和传输时延．这是数据网络中的两重要概念。考虑两台主机A、B用一条速率为 R bps的链路相连。假定这两台主机相隔 m 米。沿该链路的传播速率为 s m/s。从A主机向B主机发送长度 L 比特的分组。**

  **a. 用m、s来表示传播时延 d_prop**

  **b. 用L、R来确定该分组的传输时间仁 d_trans**

  **c. 忽略处理和排队时延，得出端到端时延的表达式**

  **d. 假定主机 在时刻 t=0 开始传输该分组 在时刻 t = d_trans 该分组的最后一个比特在什么地方？**

  **e. 假定 d_prop 大于 d_trans，在时刻 t = d_trans, 该分组的第1个比特在何处？**

  **f. 假定 dvw11 小于 dltlm~ 在时刻 = dllll.119 该分组的第 个比特在何处**

  **g. 假定 s = 2.5 * 10^8, L = 120 比特，R = 56kbps., 求出使d_prop等于d_trans的距离 m**

  答案：

  a. `d_prop = m/s s`
  
  b. `d_trans = L/R s`

  c. `d_end_to_end = (m/s + L/R) s

  d. 最后一个比特刚刚离开主机A。

  e. 不知道
  
  f. 不知道
  
  g. `m = L*S/R = 120 * 2.5 * 10^8 / 56 * 10^3 = 536 km`
